name: ivon
project: ivon
program: 12_sam_vs_ivon.py
metric:
  name: test/mc_loss
  goal: minimize
method: bayes
parameters:
  lr:
    distribution: normal
    mu: 5
    sigma: 1
  dp:
    distribution: log_normal
    mu: 1
    sigma: 0.5
  prior_prec:
    distribution: int_uniform
    min: 50
    max: 350
  warmup_steps:
    values: [0, 50, 100]
  lr_sche:
    values: ['cos']
  cooldown_epochs:
    values: [0, 10]
  da-factor:
    values: [1, 3, 5, 10]
command:
    - ${env}
    - python
    -   12_sam_vs_ivon.py
    -     --dir=/sqfs/work/jh220009/z6b038/ivon
    -     --device=cuda
    -     --dataset=CIFAR10
    -     --data_path=/sqfs/work/jh220009/z6b038/data
    -     --model=cifar_resnet_20
    -     --opt=ivon
    -     --batch_size=2048
    -     --mc_samples=8
    -     --test_mc_samples=8
    -     --momentum_grad=0.8
    -     --momentum_hess=0.9
    -     --epochs=160
    -     ${args}

name: ivon
project: ivon
program: 12_sam_vs_ivon.py
metric:
  name: test/mc_loss
  goal: minimize
method: bayes
parameters:
  lr:
    values: [8,7,6,5,4,3]
  dp:
    values: [7,6,5,4,3,2,1]
  prior_prec:
    values: [350,300,250,200]
  warmup_steps:
    values: [0, 50, 100]
  lr_sche:
    values: ['cos']
  cooldown_epochs:
    values: [0, 10]
  da-factor:
    values: [1]
command:
    - ${env}
    - python
    -   12_sam_vs_ivon.py
    -     --dir=/sqfs/work/jh220009/z6b038/ivon
    -     --device=cuda
    -     --dataset=CIFAR10
    -     --data_path=/sqfs/work/jh220009/z6b038/data
    -     --model=cifar_resnet_20
    -     --opt=ivon
    -     --batch_size=2048
    -     --mc_samples=8
    -     --test_mc_samples=8
    -     --momentum_grad=0.8
    -     --momentum_hess=0.9
    -     --epochs=160
    -     ${args}
